---
layout: single
title:  "🖥️ 회의록(2024-02-26)"
excerpt: "온라인, 주제 신청서 피드백 수용"
categories: Meeting
# tag: [python, blog, food]
toc: true
toc_sticky: true
typora-root-url: ../
auto_profile: false
# sidebar:
#    nav: "docs"
# search: false
---

<br/>

**[활동 기록]**  
활동 기간 : 2024-02-26 (금) 13:00 ~ 22:50  
활동 장소 : 온라인 디스코드  
참여자 : [정동교], 고명훈, 김성웅, 김우찬  
기록자 : [정동교] 
{: .notice--danger .text-center}

<br/>

---

# 1. 피드백 답변

> 주제를 신청한 결과, 여러 가지 피드백을 받은 후 반려되었음. 해당 피드백에 대한 추가 답변을 기록함.

<br>

## 피드백 (1)

- **Q. 색상 유사도를 검사를 하는데, 우리가 보기에 rgb (255 0 0), (155,0,0)과 같은 경우 색은 같지만 명도가 다르다고 봐야되는데 명도까지 고려해서 알고리즘을 짜는것인지?**
- A. CIEDE2000 자체가 인간이 인지하는 밝기(명도)까지 고려하여 설계된 색공간이기 때문에 deltaE(color distance)를 구하는 과정에서 그 자체로 고려 된다.

<br>

- **Q. 만약 같은 원단에 대해서 인풋을 이렇게 다르게 돌려서 줄 수 있는데 이것도 가능한가?**

  ![image-20240304222939346](/images/2024-02-26-회의록(2024-02-26)/image-20240304222939346.png){: .img-width-large}

- A. 입샛노랑 팀이 조사하는 과정에서 주로 다룬 원단은 패턴이나 색상이 고르게 분포된 것들이었기 때문에 회전에 따라 input이 바뀌는 것에 대해서는 크게 고려하지 못했었다. 이는 추가로 고려해 보아야 하는 사항인 것으로 생각됨. 그런데, 해당 문제는 커널을 여러 방향으로 슬라이딩 시키면서 스무딩하는 방식으로 고른 결과를 도출하도록 만들 수 있을 것으로 생각됨. 즉, 커널을 슬라이딩 시키기 이전부터 이미 색상 군집이 구분된 상황이기 때문에, 한 색상에 대한 평균을 구할 때는 다른 색상의 영향을 고려하지 않을 수 있고, 이미지 자체에서 패턴의 방향성을 고려해서 처음부터 대칭적인 방향에 대해서 슬라이딩을 시켜서 개선할 수 있을것.

<br>

## 피드백 (2)

- **Q. (1) 차이를 알고 피드백을 줄때, r색상이 부족하다 라는것은 쉬운 문제인데, 'r 색상이 염료 몇 그램 or 리터 부족하다.'와 같은 방식으로 제시될 수는 없는가?**
- **Q. (2) 또, 공장측에서 배합을 여러번하는 문제를 줄이고자 하는 것인데 그게 목표라면, 무슨 색상이 부족하다보다 염료가 몇그램 더 들어가야 된다가 맞지 않는가?** 
- **Q. (3) 타겟하는 문제가 정확히 무엇인가?  (*피드백을 통해 공장측에서 배합하는 여러번 시행착오를 줄이는게 맞는가*)**

<br>

> 답변이 질문 순서대로 구성되지는 않았으므로, 읽는데 주의 필요함.

<br>

- A. (1) 염료 피드백 기능에 대해 답변드리기에 앞서, 먼저 저희가 집중하고자 하는 핵심에 대해 말씀드리고자 합니다. 입샛노랑 팀이 가장 집중하고자 하는 기능은 **지금까지 현장에서 문제 사항이었던 다색상 원단의 유사도 비교 문제를 해결하는 것**입니다. 샘플을 원본과 동일하게 만들기 위해서 염료의 양을 조절하는 과정이 중요한 것은 사실입니다. 하지만 염료의 양에 대한 피드백을 제공하기 위해서는 고려해야 할 사항이 다소 많습니다.(이 내용은 뒤에 추가적으로 서술하였습니다.) 따라서 저희가 제공하는 **피드백은 유사도 분석에 더 초점이 맞추어져 있다**고 할 수 있습니다. 

<br>

- A. (2) 현재 저희 팀이 주제 신청서에 제시한 내용은 ‘**샘플 원단이 원본 원단 대비 어떤 색의 영향이 강한가, 혹은 약한가**’와 같은 피드백을 제공한다는 것입니다. 전문가와의 인터뷰를 통해 실무 현장에서 고객의 클레임은 “**원단에서 특정 색이 강한 것으로 보이기 때문에 이 색상의 영향을 줄여달라**” 등의 방식으로 주어지는 것을 확인했습니다. 하지만 원단 생산자 측은 클라이언트의 클레임이 그들의 주관에 의해서 제시된 것이기 때문에 이 문제에 동의하지 못하는 경우가 있다는 것 또한 추가적인 문제 상황이 됩니다. 따라서 저희는 가장 1차적인 피드백으로, 원본 원단에 대비하여 샘플 원단이 실제로 어떠한 색이 강한지, 그 경향성을 보여주는 것이 우선이라고 판단했습니다. 예를 들어, 클라이언트가 “샘플 원단이 원본 원단보다 노란색이 강하다. 노란색을 줄여달라.”라고 한다면, 원단 생산자 측은 이에 동의하지 못할 수 있습니다. 따라서 본 제품을 통해 실제로 노란색의 영향이 강한지, 약한지, 혹은 동일한지를 확인할 수 있으며, 만약 실제로 노란색이 강하다면, 원본 원단 대비 샘플 원단의 노란색이 얼마나 강한지 비율을 확인할 수 있기 때문에 염료의 재혼합 비율을 선정하는 데 도움을 받을 수 있습니다. 저희가 제시할 수 있는 피드백은 여기까지 입니다.

<br>

- A. (3) 염료의 양(*즉 혼합 과정에서 염료가 용액에 투입되는 양*)에 대한 정량적인 피드백을 주는 것도 필요한 기능이지만, **주어진 개발 기간 안에 해당 기능까지 개발하는 것은 현실적으로 어렵다고 판단**했습니다. 그 이유는 원단의 염색 자체에 영향을 주는 요소가 매우 다양하기 때문입니다. 그 종류로는 단색 분말 염료의 제조사에 따른 특성 차이, 단색 분말 염료의 비율 (염색액의 농도), 염료를 배합하는 장소의 기온 및 염색액의 온도, 염색액이 섬유에 흡수되는데 걸린 시간 등이 있습니다. 이렇듯 원하는 색을 만들기까지 영향을 주는 요소가 매우 많기 때문에, 단순히 투입해야 하는 염료의 그램 수 등을 제시하는 것으로 예상되는 결과(원하는 색상)를 도출할 수 있을지 확신할 수 없다고 판단했습니다. 즉, 염료에 대한 구체적 수치를 피드백으로 제공하는 것은 현재로서는 통제하기 힘든 부분이라고 생각되며, 개발 과정에서 실질적 효과를 확인하기 위해서는 실제 공장과의 연계 등이 필요할 것이라고 생각합니다. 따라서 **본 기능은 2학기에 추가 개발 기간을 가지며 현장 실무자 및 전문가와의 추가 연계 등을 통해 개발하는 것을 고려할 수 있을 것으로 생각**합니다.

  다른 방안으로, **염료의 배합 과정에 영향을 준 요소를 데이터화하는 기능을 제공하는 것을 고려**할 수 있습니다. 공장 별로 원단의 색상에 영향을 주는 요소가 다르기 때문에, 각 공장에서 특정한 색상을 만드는데 영향을 준 요소를 기록한다면, 추후에 해당 색상을 다시 만드는데 활용하여 배합에 소요되는 시간을 단축할 수 있을 것입니다. 또한 이 데이터가 축척될 경우, 색상의 비율에 따라 염료를 얼마나 조절해야 하는지에 대한 상관관계도 파악하여 공장별로 염료의 수치적 피드백이 가능할 것입니다.

<br>

## 반려

> 다음과 같은 내용으로 반려되었음.

답변 감사합니다. 캡스턴 주제로 선정하기에는 피드백으로써 색상을 비교하여 어느 색상이 강하고 약한지를 판단하는 것은 간단한 문제로 판단됩니다.(*rgb 채널에 따라 값을 받아오고 혼합하여 색상비교를 하면 되기에, 또한 기존 색상유사도에서 유사도알고리즘만 변경되는 것이기에*), 다만 다색상을 비교하는 것은 매우 좋은 아이디어라고 판단되나 이 또한 픽셀별로 구분을 하면 되지 않을까라는 생각이며 알고리즘 또한 이를 기반으로 한다고 판단됩니다. 따라서 가치가 있다고 판단이 된다면 추가적인 기능을 고려해보거나, 아니라면 새로운 주제를 선정하는 것을 추천드립니다.

입샛노랑 팀은 반려 사유가 합당하지 못하다고 판단하여 아이디어에 대해 추가적으로 어필하였음.
{: .notice--success .text-center}

<br>

## 반려에 대한 질문

- **Q. (*입샛노랑 측에서 질문한 것임.*) 안녕하십니까. 금일 입샛노랑 채팅에서 오전 10:13에 질문주신 내용에 대해서 여쭤볼 내용이 있어 작성드립니다. 질문에서 '색상 비교는 너무 쉬운 문제라서' 라고 말씀해주셨는데, 해당 내용이 유사도 검출 후 피드백을 제공하는 단계에서의 색상 비교가 간단하다고 말씀하신 건지(히스토그램을 통한 비교), 아니면 유사도를 검출하기 위해 색상을 비교하는 과정 자체가 간단하다고 말씀하신 건지 확인을 부탁드리고자 질문드립니다.**

- A. 색을 검출하는 단계와 두 색을 비교하는 것이 간단하다는 말이었습니다!

<br>

## 추가 어필 (1)

안녕하십니까. 제시해 주신 주제 관련 피드백에 대해서 추가로 질문드리고 싶은 사항이 있어 두 가지 질문을 작성드립니다.

<br>

1. 주제 신청서에 작성된 색상 간의 유사도를 도출하는 전체 과정에 대해서 추가적인 가치 반영이 가능한지 확인을 부탁드리고 싶습니다.

   본 주제 신청서를 작성하는 과정에서 저희 팀이 가장 오랜 시간 회의를 진행한 부분은, 조도에 의해 원단의 원본 색상이 바뀌는 영향을 최소화하고, 오차없이 최대한 원본 색상에 가까운 대표 색상 코드를 도출하기 위한 방법을 마련하는 것입니다. 현재 색온도 5700K(*자연광과 가장 유사한 색온도*), 연색성(*인공 조명의 원본색 재현성*) 85Ra 이상의 조명을 사용하고자 하므로, 원단 원본과의 색채의 차이는 거의 발생하지 않는다고 볼 수 있고, 따라서 원본 색과의 밝기 차이를 조절하는 것이 가장 중요합니다. 이러한 원본 색과의 밝기 차이를 보정하기 위해 특별한 보정값을 생성하고자 합니다. 이 과정에서 단순한 픽셀 단위로 1대1 비교를 통해 픽셀 별 보정값을 생성하는 것이 아니라, 지역에 따라 존재할 수 있는 조도의 차이를 최소화하기 위하여 조도센서와 연계하는 과정이 필요합니다. (*이때 지역에 따른 조도 차이란, 광원이 조명을 균일하게 전달하지 못하여 원단에서 발생할 수 있는 국부적 조도 차이를 말합니다.*) 즉, 실시간으로 지역별 조도의 상대적 세기를 계산해서 밝기에 대한 가중치를 설정해야 하며, 이를 모든 20개의 레퍼런스 팬톤 면 스와치에 대해서 적용해보고, 좋은 성능이 도출되도록 가중치를 반영하는 과정이 필요하기 때문에 간단하게 해결할 수 없다고 생각합니다. 

   조도와 오차에 대비한 보정치를 생성한 이후에는, 다색상 원단 스와치를 촬영하고, 데이터 포인트의 밀도를 기반으로 한 DBSCAN 클러스터링 방식을 통해 색상 군집을 추출하게 됩니다. 이전에 보고서에서 제시된 바와 같이 Kernel을 사용한 Sliding Window를 적용해, 지역별로 존재할 수 있는 조도 차이의 영향을 최소화한 평균 대표 색상을 구하고자 하였습니다. 그러나 Kernel별 픽셀값에 대한 평균을 구하는 것만으로는 객관적 결과를 도출하기 어려울 것이며, 따라서 정확한 색상 유사도를 판단하기 위해서는, 삼차원 공간 상에서, 각 픽셀과 해당 픽셀이 포함된 군집에서 밀도가 가장 높은 지점을 파악하고, 해당 지점과 픽셀 간의 거리에 따른 반영치를 추가적으로 가중해야 합니다. 또한, 다색상 원단의 유사도를 비교하는 경우, 색상 군집별 대표 색상을 구하므로, 여러 개의 대표 색상이 도출될 수 있습니다. 이 경우, 각 대표 색상이 원단 내에서 차지하고 있는 면적에 비례하여 유사도를 계산하는 과정이 필요하게 되며, 이전 단락에서 언급되었던 지역에 따른 밝기의 가중 또한 반영되어야 하기 때문에, 이러한 방식은 단순 픽셀값 비교에 의한 유사도 검출 과정과는 차이가 있다고 생각합니다.

    그리고 해당 방식이 레퍼런스 스와치에 대해서 올바른 결과를 도출하는지 또한 확인하는 과정이 필요하므로, 많은 시간이 소요될 것이라고 생각합니다.  이전 단락에서 언급된 대표 색상 코드를 도출하는 과정을 거친 후에는, 해당 대표 색상 간의 유사도를 분석하기 위하여 사람의 인지를 더욱 잘 반영하는 CIEDE2000 방식해 color distance(*색차*)를 구하게 됩니다. 그런데, 해당 알고리즘을 통해 적합한 결과를 얻기 위해서는 내부적으로 사용되는 세 개의 parameter 값을 적절하게 조절하는 과정이 필요합니다. 이를 위해서는 해당 parameter가 결괏값에 수치적으로 어떠한 영향을 미치는지 분석하는 과정이 필요합니다. 또한, 처음 의도하였던 바와 같이, 최대한 객관적인 원본 색상 코드를 도출하기 위해서는 20개의 레퍼런스 팬톤 면 스와치를 바탕으로 적절한 결과를 도출할 수 있는 parameter 값을 찾는 과정이 필수적입니다. 

   지금까지 다색상 원단의 색상 유사도 검출 시스템을 기획하며 정확한 결과를 도출하기 위한 보정 과정 및 알고리즘을 자체적으로 철저하게 설계하고자 하였습니다. 상술한 내용이 주제 적합성과 관련하여 가치를 인정받을 수 있는지 검토를 부탁드리고 싶습니다.

<br>

2. 금일 입샛노랑 채널에서 15:49에 질문에 대한 답변을 드렸는데, 해당 질문에서 데이터베이스를 활용한 원단 염색 환경의 데이터화를 통해 사용자에게 피드백을 제공하는 방식을 고안하였습니다. 이 방식이 피드백 방식으로 받아들여질 수 없는지 검토를 부탁드리고 싶습니다.

<br>

## 추가 어필 (2)

1. **핵심**

   - 본 프로젝트의 핵심은 **사람의 눈으로 인지하기 힘든 미묘한 색차를 객관적 수치로 나타낼 수 있는 방법이 없다**는 것입니다.

   - 30년 경력의 원단 생산 공장 측 전문가와 인터뷰한 결과, 겉으로 보기에는 비슷한 색으로 보이는 원단이 있더라도, 사람의 시각 인지는 상이하기 때문에, 색상에 대한 상호 간의 주관적 의견이 일치하기 힘들다는 점을 지적했습니다. 

   - 여기서 가장 큰 문제점은 원단 생산자 측에서 몇 번이나 클라이언트의 클레임을 반영하여 재염색을 하더라도, 여전히 고객의 입장인 클라이언트의 주관적 판단에만 의존해서 또 다시 클레임을 들어주어야 한다는 것입니다. 따라서 원단 생산자는 아무리  재염색을 하더라도, 고객의 요구를 들어줄 수밖에 없기 때문에 시간적/경제적 손해가 발생합니다.

   - 전문가는 이러한 문제를 지적하였으며, **통제된 환경에서 객관적으로 측정된, 두 원단 간의 색상 유사도를 판별하여, 99% 등과 같은 수치로 제시하는 것이 가장 중요**하다고 말했습니다.

   - 따라서 저희 팀은 **일정한 조명 환경을 통해 원단의 정확한 색상을 객관적으로 뽑아내어 수치화하고, 기존에는 불가능하던 다색상 원단 간의 색상 유사도를 사람의 인지에 가장 가까운 CIELAB 색공간으로 추출하는데 중점**을 두고 있습니다.

<br>

2) **기술**

   - 원단의 원본색을 추출할 수 있는 **자연광과 유사한 환경을 조성**, RGB 값이 확보된 **레퍼런스 스와치**(면) 20개를 측정하고, 이를 바탕으로 **지역적 밝기 차이를 보정하는 보정치를 생성**한다.

   - **DBSCAN 클러스터링**을 통해 색상 군집을 구분하고, Kernel을 사용한 **Sliding Window**를 사용해 **지역 별로 존재하는 조도 차이의 영향을 최소화한 첫 번째 색상 평균을 생성**한다.

   - 삼차원 공간 상에서, 각 색상 군집 별로 **밀도가 가장 높은 지점**을 찾아내고, **해당 지점에 가까울 수록 픽셀에 높은 가중치를 부여하여 두 번째 색상 평균을 생성**한다. (빈도를 고려하는 방식)

   - 1번에서 구한 지역적 밝기 차이를 2번에 적용하고, 최종적으로 2번과 3번에 대한 평균을 계산하여 대표 색상을 추출한다.

   - 색차를 계산하는 **CIEDE2000**의 세 가지 hyperparameter를 조절해가며, 레퍼런스 스와치에 대해 최적의 결과가 나오도록 보정치를 추가로 조절한다.

   - 최종적으로 **대표 색상을 기반으로 유사도를 계산**하며, 다색상 원단의 경우에는 해당 색상 군집의 면적에 비례하여 가중한 유사도를 계산한다.

<br>

3) **피드백에서 부족한 점 개선**

   - 현재 과정에서 개발할 때 피드백을 제공하기 어렵다고 생각했던 이유는, 개발 시간이 부족할 것으로 예상했기 때문입니다. 하지만 개발이 불가능한 것은 아니며, 추가적인 회의를 거쳐 개발 단계를 최대한 단축하겠습니다.

   - 이렇게 시간을 확보한 후, RGB 히스토그램을 바탕으로 한 R, G, B의 비율 차이를 바탕으로, 염료의 비율을 어떻게 개선해야 하는지 수치적으로 제시하겠습니다. (*조사한 바에 따르면 염료는 비율에 따라 조합되기 때문입니다.*) 사전에 인터뷰한 원단 생산 공장 측 전문가분께 요청하여 이러한 피드백이 실제로 효과를 가지는지 확인한 후, 개선하는 과정까지 진행하도록 하겠습니다.

<br>

## 피드백 (4)

- **Q. (1) 클라이언트가 제시하는 ‘샘플’은 어떻게 제공되는가? 비슷한 샘플을 주면서 색 조정을 해달라고 요청하는 것인가? 아니면 사진 같은 것을 보여주는 것인가?**
- **Q. (2) 제시한 문제 상황이 클라이언트가 계속 재염색을 하면서 자기가 원하는 색상을 찾아가는 과정은 아닌가? 색상 유사도는 사진 찍어서 비교하면 바로 알 수 있는 것을 클라이언트가 아니라고 우기는 근거가 뭔지?**
- **Q. (3) 원래 그 업종에서는 클라이언트가 갑질하면서 색 찾아가는 과정이 필수 과정은 아닌지?** 

<br>

> 말씀드리기에 앞서, 용어의 정의가 필요할 것으로 생각됩니다. 먼저 ‘**스와치**’란, 원단을 대량 생산 하기 이전에 10cm * 10cm 크기 정도로 만든 예시 원단을 말합니다. (*예시 사진을 하단에 첨부하여 전달드립니다.*) 다음으로 ‘**원본 원단**’이란, 클라이언트가 원단 생산자에게 전달하는 원단을 말합니다. 마지막으로 ‘**샘플 원단**’이란, 원단 생산자가 클라이언트의 요청에 맟춰 ‘**원본 원단**’의 **재질과 색상을 그대로 따라 만든 것**을 말합니다. (*다음 사진은 스와치의 예시 이미지입니다.*)

![image-20240304224357976](/images/2024-02-26-회의록(2024-02-26)/image-20240304224357976.png){: .img-width-large}

<br>

1. 전문가와의 인터뷰에 따르면, **클라이언트는 원단 생산자에게 항상 ‘원본 원단’의 실물을 전달**하며, 해당 ‘원본 원단’과 동일한 재질 및 색상을 가진 ‘스와치’를 만들어달라고 요청합니다. 이것이 ‘샘플 원단’ 입니다. 전문가의 말에 따르면 **절대로 ‘원본 원단’을 사진으로 전달하지 않는데**, 그 이유는 **서로 다른 환경에서 원단을 촬영하여 사진을 보낼 경우, 실제 색상과 다르게 보일 수 있기 때문**입니다. 

2. 즉, 업계에서는 조명 조건이 통제되지 않은 상황에서 카메라로 촬영한 원단으로는, 원본 색상 판단이 불가능하다고 판단하고 있으며, 이는 클라이언트와 원단 생산자가 공통으로 인정하고 있는 사항입니다. 물체의 색상은 자연광을 받고 있을 때 실제 색상을 띤다고 알려져 있습니다. 그러나 대부분의 실내 환경에서는 자연광과 유사한 환경이 구현되어 있지 않습니다. 만약 자연광을 받은 상태에서 촬영한다고 해도, 물체에 생기는 그림자가 통제되지 않으며, 조도 차이로 인한 미묘한 색상 차이가 발생하므로, **반드시 조명 환경이 통제된 시스템이 필요**합니다.

3. **원단 생산자**는 ‘**원본 원단**’의 **실물 스와치**를 전달받고, 그 스와치와 동일한 재질 및 색상의 ‘**샘플 원단**’을 제작합니다. 이는 ‘원본 원단’을 대량으로 생산하기 전, 원단 생산자가 ‘원본 원단’과 동일한 원단을 만들 수 있는지 클라이언트가 확인하는 과정이라고 할 수 있습니다.

4. 그런데 이때, 클라이언트와 **원단 생산자 간의에서 색상 유사도에 대한 의견 차이가 발생**합니다. 그 이유는 클라이언트가 육안으로 색상을 판단할 때, 기존에 색상을 확인했던 환경의 조명과 색온도가 다르거나, 조명의 세기가 다른 곳에 위치하고 있다면, 색상이 다르게 인지될 수 있기 때문입니다. 이 경우, 클라이언트는 원단 생산자에게 ‘샘플 원단’을 다시 만들기를 요구합니다.

5. 클라이언트의 지속적인 클레임이 수용되는 이유는, **원단의 색상 차이를 비교할 수 있는 정량적인 기준이 없다는 점에서 발생**합니다. 클라이언트의 입장에서는 원단 생산자가 본인의 의견을 수용해주지 않는다면 다른 공장으로 가면 그만이지만, 원단 생산자의 입장에서는 그 고객을 놓치면 발생할 수 있는 기대 수익이 감소할 수 있습니다. 따라서 ‘샘플 원단’과 ‘원본 원단’의 색상이 완벽히 동일하다고 판단되더라도, 계속해서 재염색을 하며 클라이언트의 요구를 충족시킬 수밖에 없습니다. 이 과정에서, 한 번의 재염색을 실시하는데 약 2~3주의 시간이 소요되므로 시간 또한 낭비됩니다.

6. 지금까지 주관적으로 이루어졌던 색상 평가에 대한 객관적인 기준을 갖는다면, 클라이언트의 주관으로 발생하는 클레임을 줄이고 상호 간에 합의가 가능한 객관적 기준을 설립하는데 기여할 수 있을 것입니다. **저희 팀의 프로젝트가 목표하는 바는, 조명 환경을 통제하고 해당 원단의 대표 색상을 추출한 것을 바탕으로 색상의 유사도를 평가하여, 클라이언트의 일방적인 클레임이 존재할 수 없도록 만드는 데에 있습니다.**

<br>

# 2. 추가 논의

## 추후 일정

- 이후에 새롭게 전달받는 피드백을 수용하여 내용을 수정하도록 한다.
- 추가 피드백을 받기 이전까지는 별도로 할 수 있는 것이 없으므로, 피드백이 올 때까지 대기한다.

<br>